<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ Console Auto Form</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0a0e17 0%, #151a2d 100%);
            min-height: 100vh;
            padding: 40px;
        }
        
        .main-content {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(20, 25, 40, 0.9);
            border-radius: 20px;
            border: 2px solid transparent;
            background-clip: padding-box;
            position: relative;
            box-shadow: 
                0 25px 50px -12px rgba(0, 0, 0, 0.3),
                0 0 0 1px rgba(66, 153, 225, 0.1),
                inset 0 0 20px rgba(66, 153, 225, 0.05);
            overflow: hidden;
        }
        
        .main-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 20px;
            padding: 2px;
            background: linear-gradient(
                135deg,
                rgba(139, 92, 246, 0.5),
                rgba(66, 153, 225, 0.5),
                rgba(139, 92, 246, 0.5)
            );
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            z-index: -1;
        }
        
        .main-header {
            background: linear-gradient(90deg, 
                rgba(30, 41, 59, 0.95) 0%, 
                rgba(66, 153, 225, 0.25) 50%,
                rgba(30, 41, 59, 0.95) 100%);
            padding: 25px 30px;
            border-bottom: 1px solid rgba(66, 153, 225, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
        }
        
        .main-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 5%;
            right: 5%;
            height: 1px;
            background: linear-gradient(90deg, 
                transparent,
                rgba(66, 153, 225, 0.5),
                rgba(139, 92, 246, 0.5),
                rgba(66, 153, 225, 0.5),
                transparent);
        }
        
        .header-title {
            flex: 1;
        }
        
        .header-title h2 {
            color: #ffffff;
            font-size: 32px;
            margin-bottom: 5px;
            text-shadow: 0 2px 10px rgba(66, 153, 225, 0.3);
            font-weight: 700;
            letter-spacing: 0.5px;
        }
        
        .header-title p {
            color: #90cdf4;
            font-size: 16px;
            opacity: 0.9;
        }
        
        .monkey-header {
            font-size: 48px;
            animation: bounce 2s infinite alternate;
            opacity: 1;
            text-shadow: 
                0 0 20px rgba(255, 215, 0, 0.5),
                0 0 40px rgba(255, 215, 0, 0.2);
            transform-origin: center;
        }
        
        .form-section {
            padding: 30px;
            background: transparent;
        }
        
        .form-group {
            margin-bottom: 28px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #90cdf4;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .required::after {
            content: " *";
            color: #ff3333;
            font-weight: bold;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 16px 18px;
            border: 1px solid rgba(66, 153, 225, 0.3);
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
            background: rgba(30, 41, 59, 0.7) !important;
            color: #ffffff;
        }
        
        .form-group input::placeholder {
            color: #a0aec0;
        }
        
        .form-group select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%2390cdf4' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 18px center;
            background-size: 20px;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 
                0 0 0 2px rgba(66, 153, 225, 0.2),
                0 4px 12px rgba(66, 153, 225, 0.1);
            background: rgba(30, 41, 59, 0.9) !important;
        }
        
        .form-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .form-option {
            flex: 1;
            padding: 22px 18px;
            border: 2px solid rgba(66, 153, 225, 0.2);
            border-radius: 14px;
            background: rgba(30, 41, 59, 0.7);
            cursor: pointer;
            text-align: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .form-option:hover {
            transform: translateY(-2px);
            border-color: rgba(66, 153, 225, 0.4);
            background: rgba(30, 41, 59, 0.8);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }
        
        .form-option[data-form="form3"].selected {
            border-color: #00cc66;
            background: linear-gradient(135deg, rgba(0, 204, 102, 0.15), rgba(30, 41, 59, 0.9));
            box-shadow: 
                0 0 20px rgba(0, 204, 102, 0.3),
                inset 0 0 0 1px rgba(0, 204, 102, 0.2);
        }
        
        .form-option[data-form="form1"].selected {
            border-color: #ff3333;
            background: linear-gradient(135deg, rgba(255, 51, 51, 0.15), rgba(30, 41, 59, 0.9));
            box-shadow: 
                0 0 20px rgba(255, 51, 51, 0.3),
                inset 0 0 0 1px rgba(255, 51, 51, 0.2);
        }
        
        .form-option[data-form="form2"].selected {
            border-color: #ff3333;
            background: linear-gradient(135deg, rgba(255, 51, 51, 0.15), rgba(30, 41, 59, 0.9));
            box-shadow: 
                0 0 20px rgba(255, 51, 51, 0.3),
                inset 0 0 0 1px rgba(255, 51, 51, 0.2);
        }
        
        .form-option.selected::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            border-radius: 14px 14px 0 0;
        }
        
        .form-option[data-form="form3"].selected::before {
            background: linear-gradient(90deg, #00cc66, #66ff99);
        }
        
        .form-option[data-form="form1"].selected::before,
        .form-option[data-form="form2"].selected::before {
            background: linear-gradient(90deg, #ff3333, #ff6666);
        }
        
        .form-option .form-icon {
            font-size: 32px;
            margin-bottom: 12px;
            display: block;
            transition: all 0.3s;
        }
        
        .form-option[data-form="form3"] .form-icon {
            color: #90cdf4;
        }
        
        .form-option[data-form="form3"].selected .form-icon {
            color: #00cc66;
            text-shadow: 0 0 15px rgba(0, 204, 102, 0.5);
        }
        
        .form-option[data-form="form1"] .form-icon,
        .form-option[data-form="form2"] .form-icon {
            color: #90cdf4;
        }
        
        .form-option[data-form="form1"].selected .form-icon,
        .form-option[data-form="form2"].selected .form-icon {
            color: #ff3333;
            text-shadow: 0 0 15px rgba(255, 51, 51, 0.5);
        }
        
        .form-option .form-name {
            font-weight: 700;
            font-size: 16px;
            margin-bottom: 6px;
            color: #ffffff;
            letter-spacing: 0.5px;
        }
        
        .form-option.selected .form-name {
            font-weight: 800;
        }
        
        .form-option[data-form="form3"].selected .form-name {
            color: #00cc66;
            text-shadow: 0 0 8px rgba(0, 204, 102, 0.3);
        }
        
        .form-option[data-form="form1"].selected .form-name,
        .form-option[data-form="form2"].selected .form-name {
            color: #ff3333;
            text-shadow: 0 0 8px rgba(255, 51, 51, 0.3);
        }
        
        .form-option .form-desc {
            font-size: 13px;
            color: #a0aec0;
            line-height: 1.5;
        }
        
        .form-option.selected .form-desc {
            color: #cccccc;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .preview-box {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid rgba(66, 153, 225, 0.25);
            border-radius: 12px;
            padding: 18px;
            margin-top: 15px;
            font-size: 14px;
            color: #a0aec0;
            line-height: 1.6;
        }
        
        .button-area {
            position: relative;
            margin: 40px 0 30px;
        }
        
        .button-separator {
            height: 1px;
            background: linear-gradient(90deg, 
                transparent,
                rgba(66, 153, 225, 0.4),
                rgba(139, 92, 246, 0.6),
                rgba(66, 153, 225, 0.4),
                transparent);
            margin: 20px 0;
        }
        
        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 10px;
        }
        
        .btn {
            padding: 18px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.1), 
                transparent);
            transition: left 0.6s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #00cc66 0%, #00aa55 100%);
            color: white;
            border: 1px solid rgba(0, 204, 102, 0.3);
            box-shadow: 
                0 4px 15px rgba(0, 204, 102, 0.2),
                0 0 0 1px rgba(0, 204, 102, 0.1);
        }
        
        .btn-success:hover {
            background: linear-gradient(135deg, #00aa55 0%, #008844 100%);
            transform: translateY(-3px);
            box-shadow: 
                0 8px 25px rgba(0, 204, 102, 0.3),
                0 0 0 1px rgba(0, 204, 102, 0.2);
        }
        
        .btn-clear {
            background: linear-gradient(135deg, #ff3333 0%, #cc0000 100%);
            color: white;
            border: 1px solid rgba(255, 51, 51, 0.3);
            box-shadow: 
                0 4px 15px rgba(255, 51, 51, 0.2),
                0 0 0 1px rgba(255, 51, 51, 0.1);
        }
        
        .btn-clear:hover {
            background: linear-gradient(135deg, #cc0000 0%, #aa0000 100%);
            transform: translateY(-3px);
            box-shadow: 
                0 8px 25px rgba(255, 51, 51, 0.3),
                0 0 0 1px rgba(255, 51, 51, 0.2);
        }
        
        .success-message {
            background: rgba(0, 204, 102, 0.1);
            border: 1px solid rgba(0, 204, 102, 0.3);
            border-left: 4px solid #00cc66;
            color: #66ff99;
            padding: 18px;
            border-radius: 12px;
            margin-top: 24px;
            display: none;
            text-align: center;
            font-size: 15px;
            line-height: 1.6;
        }
        
        .not-testable-box {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-left: 4px solid #ffc107;
            border-radius: 12px;
            padding: 18px;
            margin: 15px 0;
            color: #ffd54f;
            font-size: 14px;
            display: none;
        }
        
        .not-testable-title {
            color: #ffd700;
            font-weight: 700;
            margin-bottom: 8px;
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .not-testable-list {
            list-style: none;
            margin: 5px 0 0 0;
            padding-left: 20px;
        }
        
        .not-testable-list li {
            margin-bottom: 5px;
            padding-left: 5px;
            position: relative;
            font-size: 13px;
        }
        
        .not-testable-list li:before {
            content: "‚Ä¢";
            color: #ffc107;
            font-size: 16px;
            position: absolute;
            left: -12px;
        }
        
        /* HELP SECTION STYLES */
        .help-section-container {
            margin: 40px 30px 30px;
        }
        
        .help-section-title {
            color: #90cdf4;
            font-size: 24px;
            margin-bottom: 25px;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(66, 153, 225, 0.2);
        }
        
        .help-content-grid {
            display: flex;
            gap: 30px;
        }
        
        .help-card {
            flex: 1;
            background: linear-gradient(145deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.95));
            border-radius: 16px;
            padding: 28px;
            border: 2px solid transparent;
            background-clip: padding-box;
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(66, 153, 225, 0.1);
        }
        
        .help-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 16px;
            padding: 2px;
            background: linear-gradient(
                135deg,
                rgba(139, 92, 246, 0.3),
                rgba(66, 153, 225, 0.3),
                rgba(139, 92, 246, 0.3)
            );
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            z-index: -1;
            transition: all 0.3s;
        }
        
        .help-card:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 15px 40px rgba(0, 0, 0, 0.3),
                0 0 0 1px rgba(66, 153, 225, 0.2);
        }
        
        .help-card:hover::before {
            background: linear-gradient(
                135deg,
                rgba(139, 92, 246, 0.5),
                rgba(66, 153, 225, 0.5),
                rgba(139, 92, 246, 0.5)
            );
        }
        
        .help-card-title {
            color: #90cdf4;
            font-size: 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }
        
        .help-card-content {
            color: #ffffff;
            font-size: 15px;
            line-height: 1.7;
        }
        
        .help-card-content strong {
            color: #ffd700;
        }
        
        .help-list {
            list-style: none;
            margin: 15px 0;
            padding-left: 20px;
        }
        
        .help-list li {
            margin-bottom: 12px;
            padding-left: 12px;
            position: relative;
        }
        
        .help-list li:before {
            content: "‚Ä¢";
            color: #4299e1;
            font-size: 22px;
            position: absolute;
            left: -15px;
        }
        
        .shortcut-item {
            display: flex;
            justify-content: space-between;
            padding: 14px 0;
            border-bottom: 1px solid rgba(66, 153, 225, 0.1);
            transition: all 0.3s;
        }
        
        .shortcut-item:hover {
            background: rgba(66, 153, 225, 0.05);
            border-radius: 8px;
            padding-left: 8px;
            padding-right: 8px;
            margin: 0 -8px;
        }
        
        .shortcut-item:last-child {
            border-bottom: none;
        }
        
        .shortcut-key {
            background: rgba(30, 41, 59, 0.8);
            padding: 6px 14px;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', monospace;
            color: #fbbf24;
            border: 1px solid rgba(66, 153, 225, 0.3);
            font-weight: 600;
            min-width: 120px;
            text-align: center;
        }
        
        .shortcut-desc {
            color: #cbd5e1;
            font-weight: 500;
        }
        
        .footer-signature {
            text-align: center;
            padding: 30px;
            margin-top: 40px;
            border-top: 1px solid rgba(66, 153, 225, 0.2);
            position: relative;
        }
        
        .footer-signature::before {
            content: '';
            position: absolute;
            top: 0;
            left: 10%;
            right: 10%;
            height: 1px;
            background: linear-gradient(90deg, 
                transparent,
                rgba(66, 153, 225, 0.5),
                rgba(139, 92, 246, 0.6),
                rgba(66, 153, 225, 0.5),
                transparent);
        }
        
        .monkey-emojis {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .monkey {
            font-size: 28px;
            animation: float 3s infinite ease-in-out;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
        }
        
        .monkey:nth-child(1) {
            animation-delay: 0s;
        }
        
        .monkey:nth-child(2) {
            animation-delay: 0.5s;
        }
        
        .monkey:nth-child(3) {
            animation-delay: 1s;
        }
        
        .created-by {
            color: #ffffff;
            font-size: 18px;
            margin-bottom: 15px;
            letter-spacing: 1px;
        }
        
        .rahim-name {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(
                90deg,
                #60a5fa,
                #ffffff,
                #f9a8d4,
                #d8b4fe,
                #fbbf24,
                #34d399,
                #f87171,
                #60a5fa
            );
            background-size: 400% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientShift 6s ease infinite;
            padding: 8px 24px;
            border-radius: 12px;
            display: inline-block;
            text-shadow: 0 0 30px rgba(96, 165, 250, 0.3);
            position: relative;
        }
        
        .rahim-name::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 12px;
            padding: 2px;
            background: linear-gradient(
                135deg,
                rgba(96, 165, 250, 0.5),
                rgba(255, 255, 255, 0.3),
                rgba(249, 168, 212, 0.5),
                rgba(216, 180, 254, 0.5),
                rgba(251, 191, 36, 0.5),
                rgba(52, 211, 153, 0.5),
                rgba(248, 113, 113, 0.5),
                rgba(96, 165, 250, 0.5)
            );
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            z-index: -1;
            animation: gradientShift 6s ease infinite;
        }
        
        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-8px);
            }
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(30, 41, 59, 0.5);
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #4299e1 0%, #8b5cf6 100%);
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #3182ce 0%, #7c3aed 100%);
        }
    </style>
</head>
<body>
    <div class="main-content">
        <div class="main-header">
            <div class="header-title">
                <h2>üéÆ Console Auto Form</h2>
                <p>Professional Console Testing Tool</p>
            </div>
            <div class="monkey-header">üêµ</div>
        </div>
        
        <div class="form-section" autocomplete="off">
            <div class="form-group">
                <label class="required">SELECT FORM TYPE *</label>
                <div class="form-selector">
                    <div class="form-option selected" onclick="selectForm('form3')" id="form3Option" data-form="form3">
                        <span class="form-icon">‚úì</span>
                        <div class="form-name">PASS ALL TESTS</div>
                        <div class="form-desc">All tests passed or not testable</div>
                    </div>
                    <div class="form-option" onclick="selectForm('form1')" id="form1Option" data-form="form1">
                        <span class="form-icon">‚ùå</span>
                        <div class="form-name">FAILED TEST</div>
                        <div class="form-desc">Detailed testing with cascade logic</div>
                    </div>
                    <div class="form-option" onclick="selectForm('form2')" id="form2Option" data-form="form2">
                        <span class="form-icon">üî¥</span>
                        <div class="form-name">REJECTION</div>
                        <div class="form-desc">Single reason rejection</div>
                    </div>
                </div>
                <div class="preview-box" id="formPreview">
                    Currently selected: <strong style="color:#00cc66">PASS ALL TESTS</strong> ‚Äî All tests passed or not testable
                </div>
            </div>
            
            <div class="form-group">
                <div class="form-row">
                    <div>
                        <label class="required" for="item_id">ITEM ID *</label>
                        <input type="text" id="item_id" placeholder="Enter Item ID (e.g., 0012345)" autocomplete="off" maxlength="8">
                    </div>
                    <div>
                        <label class="required" for="serial">SERIAL NUMBER *</label>
                        <input type="text" id="serial" placeholder="Enter Serial Number" autocomplete="off">
                    </div>
                </div>
            </div>
            
            <div id="liveFormFields">
                <div class="form-group">
                    <label class="required" for="model">MODEL *</label>
                    <select id="model" autocomplete="off" onchange="updateNotTestableInfo()">
                        <option value="">-- Select Model --</option>
                        <!-- Models populated from CONFIG -->
                    </select>
                </div>
                
                <div class="form-group" id="failureFields" style="display: none;">
                    <div class="form-row">
                        <div>
                            <label class="required" for="failure_point">FIRST FAILURE POINT *</label>
                            <select id="failure_point" onchange="updateFailureReasons()" autocomplete="off">
                                <option value="">-- Select where it first failed --</option>
                                <!-- Failure points populated from CONFIG -->
                            </select>
                        </div>
                        <div>
                            <label class="required" for="failure_reason">FAILURE REASON *</label>
                            <select id="failure_reason" autocomplete="off">
                                <option value="">Select failure point first</option>
                            </select>
                        </div>
                    </div>
                    <div class="preview-box" id="previewBox">
                        Failure reason will be auto-filled based on your selection
                    </div>
                </div>
            </div>
            
            <div id="rejectionFormFields" style="display: none;">
                <div class="form-group">
                    <label class="required" for="rejection_reason">REJECTION REASON *</label>
                    <select id="rejection_reason" autocomplete="off">
                        <option value="">-- Select Rejection Reason --</option>
                        <!-- Rejection reasons populated from CONFIG -->
                    </select>
                </div>
            </div>
            
            <div id="passAllFormFields" style="display: none;">
                <div class="preview-box" style="background: rgba(0, 204, 102, 0.1); border-color: rgba(0, 204, 102, 0.3);">
                    <strong style="color: #00cc66;">‚úÖ PASS ALL TESTS MODE</strong><br>
                    All tests will be marked as "Passed" or "Not testable" based on console type.
                </div>
            </div>
            
            <div class="not-testable-box" id="notTestableBox">
                <div class="not-testable-title">
                    ‚ö†Ô∏è Tests marked as "Not testable" for this console:
                </div>
                <ul class="not-testable-list" id="notTestableList"></ul>
            </div>
            
            <div class="button-area">
                <div class="button-separator"></div>
                <div class="button-group">
                    <button class="btn btn-success" onclick="generateAndOpenForm()">
                        <i class="fas fa-rocket"></i>
                        Open Form Now
                    </button>
                    <button class="btn btn-clear" onclick="clearForm()">
                        <i class="fas fa-eraser"></i>
                        Clear Form
                    </button>
                </div>
                <div class="button-separator"></div>
            </div>
            
            <div class="success-message" id="successMessage">
                ‚úÖ Form generated successfully!<br>
                <small>Form opened in new tab.</small>
            </div>
        </div>
        
        <div class="help-section-container">
            <div class="help-section-title">
                üìö HELP & SHORTCUTS
            </div>
            
            <div class="help-content-grid">
                <div class="help-card">
                    <div class="help-card-title">
                        <i class="fas fa-graduation-cap"></i>
                        How to Use This Tool
                    </div>
                    <div class="help-card-content">
                        1. <strong>Select Form Type:</strong> Pass All Tests, Failed Test, or Rejection.
                        <br><br>
                        2. <strong>Fill Basic Info:</strong> Item ID & Serial Number (required).
                        <br><br>
                        3. <strong>For Failed Test Form:</strong> Select Model, then where it failed and why.
                        <br><br>
                        4. <strong>For Rejection Form:</strong> Choose a reason from the list.
                        <br><br>
                        5. <strong>For Pass All Form:</strong> Just fill Model - tests auto-mark as Passed/Not testable.
                    </div>
                </div>
                
                <div class="help-card">
                    <div class="help-card-title">
                        <i class="fas fa-keyboard"></i>
                        Keyboard Shortcuts
                    </div>
                    <div class="help-card-content">
                        <div class="shortcut-item">
                            <span class="shortcut-key">Ctrl + Enter</span>
                            <span class="shortcut-desc">Open Form</span>
                        </div>
                        <div class="shortcut-item">
                            <span class="shortcut-key">Ctrl + 1/2/3</span>
                            <span class="shortcut-desc">Switch Form Type</span>
                        </div>
                        <div class="shortcut-item">
                            <span class="shortcut-key">F2</span>
                            <span class="shortcut-desc">Swap ID/Serial</span>
                        </div>
                        <div class="shortcut-item">
                            <span class="shortcut-key">Tab/Enter</span>
                            <span class="shortcut-desc">Navigate fields</span>
                        </div>
                        <div class="shortcut-item">
                            <span class="shortcut-key">Esc</span>
                            <span class="shortcut-desc">Clear Form</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer-signature">
            <div class="monkey-emojis">
                <div class="monkey">üôà</div>
                <div class="monkey">üôâ</div>
                <div class="monkey">üôä</div>
            </div>
            <div class="created-by">Created by</div>
            <div class="rahim-name">RAHIM</div>
        </div>
    </div>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        // ================= CONFIGURATION SECTION =================
        const CONFIG = {
            // Google Form URLs
            GOOGLE_FORMS: {
                PASS_ALL: "https://docs.google.com/forms/d/e/1FAIpQLSdw_dydIgIk2lDK02LYyfi-4ytC5i7EEcjwCBV-t2qmcRU-aQ/viewform?pli=1&pli=1",
                FAILED_TEST: "https://docs.google.com/forms/d/e/1FAIpQLSdw_dydIgIk2lDK02LYyfi-4ytC5i7EEcjwCBV-t2qmcRU-aQ/viewform?pli=1&pli=1",
                REJECTION: "https://docs.google.com/forms/d/e/1FAIpQLSfBIRKz7rHYnRKip_CinYR1dPN7lUkor1B3goSxDQdrdktJ5g/viewform"
            },
            
            // Google Form Field IDs
            FIELD_IDS: {
                PASS_ALL: {
                    item_id: "entry.264714925",
                    serial: "entry.1467120290",
                    model: "entry.1645409711",
                    auth: "entry.1389653337",
                    boot: "entry.582532298",
                    buttons: "entry.1182612584",
                    jailbreak: "entry.496249149",
                    network: "entry.515652933",
                    accounts: "entry.1245600276",
                    ports: "entry.2000355850",
                    disc_storage: "entry.1981842962",
                    battery: "entry.1201219719",
                    display: "entry.373626164",
                    speaker_mic: "entry.1064347633",
                    load: "entry.261682137",
                    noise_smell: "entry.165249102",
                    controller: "entry.23953354",
                    accessories: "entry.926040436",
                    general: "entry.382102081"
                },
                FAILED_TEST: {
                    item_id: "entry.264714925",
                    serial: "entry.1467120290",
                    model: "entry.1645409711",
                    auth: "entry.1389653337",
                    boot: "entry.582532298",
                    buttons: "entry.1182612584",
                    jailbreak: "entry.496249149",
                    network: "entry.515652933",
                    accounts: "entry.1245600276",
                    ports: "entry.2000355850",
                    disc_storage: "entry.1981842962",
                    battery: "entry.1201219719",
                    display: "entry.373626164",
                    speaker_mic: "entry.1064347633",
                    load: "entry.261682137",
                    noise_smell: "entry.165249102",
                    controller: "entry.23953354",
                    accessories: "entry.926040436",
                    auth_why: "entry.1882150640",
                    boot_why: "entry.1965271608",
                    buttons_why: "entry.1567705433",
                    jailbreak_why: "entry.2116645276",
                    network_why: "entry.1387611846",
                    accounts_why: "entry.1009950602",
                    ports_why: "entry.910771481",
                    disc_storage_why: "entry.198376670",
                    battery_why: "entry.91471292",
                    display_why: "entry.876337039",
                    speaker_mic_why: "entry.728090706",
                    load_why: "entry.1847751109",
                    noise_smell_why: "entry.1095686758",
                    controller_why: "entry.570841000",
                    accessories_why: "entry.764500531",
                    general: "entry.382102081"
                },
                REJECTION: {
                    item_id: "entry.264714925",
                    serial: "entry.1215422911",
                    rejection_reason: "entry.1263436854",
                    general: "entry.382102081"
                }
            },
            
            // Console Models (Alphabetical, device not supported at bottom)
            MODELS: [
                "Asus ROG Ally (2023)",
                "Asus ROG Ally X (2024)",
                "Lenovo Legion Go",
                "New Nintendo 2DS XL",
                "New Nintendo 3DS",
                "New Nintendo 3DS XL",
                "Nintendo 2DS (Original)",
                "Nintendo 3DS (Original)",
                "Nintendo 3DS XL",
                "Nintendo 64 (Original)",
                "Nintendo DS",
                "Nintendo DSi",
                "Nintendo DSi XL",
                "Nintendo Game Boy",
                "Nintendo Game Boy Advance",
                "Nintendo Switch",
                "Nintendo Switch 2",
                "Nintendo Switch Lite",  // ADDED
                "Nintendo Wii",
                "Nintendo Wii U",
                "PlayStation 1",
                "PlayStation 2",
                "PlayStation 3",
                "PlayStation 4",
                "PlayStation 4 pro",
                "PlayStation 4 slim",
                "PlayStation 5",
                "PlayStation 5 digital",
                "PlayStation 5 pro",
                "PlayStation Portal 2025",
                "PlayStation Portable",
                "PlayStation Vita",
                "Steam Deck",
                "Xbox (original)",
                "Xbox 360",
                "Xbox One (Original)",
                "Xbox One S",
                "Xbox One X",
                "Xbox Series S",
                "Xbox Series X",
                "device not supported"  // MOVED TO BOTTOM
            ],
            
            // Failure Points (Alphabetical)
            FAILURE_POINTS: [
                "Accounts check",
                "Accessories",
                "Authenticity check",
                "Battery test",
                "Buttons test",
                "Controller test (incl. vibration)",
                "Disc drive and storage test",
                "Display test",
                "Jailbreak test",
                "Load test",
                "Network connections test",
                "Noise and smell test",
                "Ports test",
                "Powering on and booting up",
                "Speaker and microphone test"
            ],
            
            // Failure Reasons (Alphabetical within categories)
            FAILURE_REASONS: {
                "Accounts check": [
                    "Blacklisted Device",
                    "Locked Device",
                    "Other"
                ],
                "Accessories": [
                    "Camera issues",
                    "Critical accessory issues",
                    "Flash issues",
                    "Other"
                ],
                "Authenticity check": [
                    "Likely counterfeit device",
                    "Likely nongenuine parts",
                    "Other",
                    "Seal issues"
                ],
                "Battery test": [
                    "Battery issues",
                    "Does not charge",
                    "Other",
                    "Safety issues",
                    "Swollen battery"
                ],
                "Buttons test": [
                    "Button issues",
                    "Other"
                ],
                "Controller test (incl. vibration)": [
                    "Controller issues",
                    "Other",
                    "Vibration issues"
                ],
                "Disc drive and storage test": [
                    "Disc drive issues",
                    "Other",
                    "SD card issues",
                    "Storage device issues"
                ],
                "Display test": [
                    "Other",
                    "Screen issues"
                ],
                "Jailbreak test": [
                    "Jailbroken or rooted device",
                    "Other"
                ],
                "Load test": [
                    "Game load issues",
                    "Other",
                    "Sensor issues"
                ],
                "Network connections test": [
                    "Bluetooth issues",
                    "Ethernet issues",
                    "NFC issues",
                    "Other",
                    "WiFi issues"
                ],
                "Noise and smell test": [
                    "Defective Fan",
                    "Heat issues",
                    "Other",
                    "Smell issues (burning smell,broken capacitors)"
                ],
                "Ports test": [
                    "HDMI issues",
                    "Other",
                    "Port issues",
                    "USB issues",
                    "Video signal errors"
                ],
                "Powering on and booting up": [
                    "Charging failure",
                    "Liquid damaged device",
                    "Not starting",
                    "Other",
                    "Short circuiting device",
                    "Software error",
                    "Video signal errors",
                    "Wireless charging failure"
                ],
                "Speaker and microphone test": [
                    "Microphone issues",
                    "Other",
                    "Speaker issues"
                ]
            },
            
            // Rejection Reasons (Alphabetical)
            REJECTION_REASONS: [
                "ARRIVED_DAMAGED",
                "BLACKLISTED_DEVICE",
                "BROKEN_SEAL",
                "CONSOLE_ACCESSORY_ISSUES",
                "CONTROLLER_ISSUES",
                "CRITICAL_ACCESSORY_ISSUES",
                "CRITICAL_CONDITION_MISMATCH",
                "DAMAGED_IN_WAREHOUSE",
                "DISC_DRIVE_ISSUES",
                "EMPTY_PARCEL",
                "JAIL_BROKEN_OR_ROOTED",
                "LIQUID_DAMAGE",
                "LIKELY_COUNTERFEIT_DEVICE",
                "LOCKED_DEVICE",
                "MULTIPLE_ITEMS",
                "NOT_STARTING",
                "SAFETY_ISSUES",
                "SEAL_ISSUES",
                "SOFTWARE_ISSUES",
                "SWOLLEN_BATTERY",
                "UNSUPPORTED_DEVICE",
                "WRONG_ITEM",
                "WRONG_MODEL",
                "WRONG_SPECIFICATIONS",
                "WRONG_STORAGE_CAPACITY"
            ]
        };

        // ================= CONSTANTS =================
        const CONSTANTS = {
            // Test order for cascade logic
            TESTS: ["auth", "boot", "buttons", "jailbreak", "network", "accounts", "ports", "disc_storage", "battery", "display", "speaker_mic", "load", "noise_smell", "controller", "accessories"],
            
            // Special console rules
            SPECIAL_CONSOLES: {
                "PlayStation 3": ["battery", "display", "speaker_mic"],
                "PlayStation 4": ["battery", "display", "speaker_mic"],
                "PlayStation 4 slim": ["battery", "display", "speaker_mic"],
                "PlayStation 4 pro": ["battery", "display", "speaker_mic"],
                "PlayStation 5": ["battery", "display", "speaker_mic"],
                "PlayStation 5 digital": ["battery", "display", "speaker_mic", "disc_storage"],
                "PlayStation 5 pro": ["battery", "display", "speaker_mic"],
                "Xbox One (Original)": ["battery", "display", "speaker_mic"],
                "Xbox One S": ["battery", "display", "speaker_mic"],
                "Xbox One X": ["battery", "display", "speaker_mic"],
                "Xbox Series X": ["battery", "display", "speaker_mic"],
                "Xbox 360": ["battery", "display", "speaker_mic"],
                "Xbox Series S": ["battery", "display", "speaker_mic", "disc_storage"],
                "PlayStation Portable": ["controller"],
                "PlayStation Portal 2025": ["disc_storage", "load"],
                "PlayStation Vita": ["controller"],
                "Nintendo DS": ["network", "accounts", "controller"],
                "Nintendo 2DS (Original)": ["controller"],
                "Nintendo 3DS (Original)": ["controller"],
                "Nintendo 3DS XL": ["controller"],
                "New Nintendo 3DS": ["controller"],
                "New Nintendo 3DS XL": ["controller"],
                "New Nintendo 2DS XL": ["controller"],
                "Nintendo DSi": ["controller"],
                "Nintendo DSi XL": ["controller"],
                "Nintendo Wii": ["display", "speaker_mic", "battery"],
                "Nintendo 64 (Original)": ["network", "accounts", "battery", "speaker_mic", "display"],
                "PlayStation 1": ["network", "accounts", "battery", "speaker_mic", "display"],
                "PlayStation 2": ["network", "accounts", "battery", "speaker_mic", "display"],
                "Nintendo Switch Lite": ["controller"]  // ADDED: Controller not testable
            }
        };

        // ================= RUNTIME VARIABLES =================
        let CURRENT_FORM = 'form3'; // Start with PASS ALL
        let currentFieldIds = CONFIG.FIELD_IDS.PASS_ALL;
        let lastF2Time = 0;

        // ================= INITIALIZATION =================
        document.addEventListener('DOMContentLoaded', function() {
            populateDropdowns();
            setupAutoNavigation();
            setupKeyboardShortcuts();
            selectForm('form3'); // Start with PASS ALL
            document.getElementById('item_id').focus();
        });

        // ================= DROPDOWN FUNCTIONS =================
        function populateDropdowns() {
            // Populate Models
            const modelSelect = document.getElementById('model');
            CONFIG.MODELS.forEach(model => {
                const option = document.createElement('option');
                option.value = model;
                option.textContent = model;
                modelSelect.appendChild(option);
            });
            
            // Populate Failure Points
            const failurePointSelect = document.getElementById('failure_point');
            CONFIG.FAILURE_POINTS.forEach(point => {
                const option = document.createElement('option');
                option.value = getFailurePointKey(point);
                option.textContent = point;
                failurePointSelect.appendChild(option);
            });
            
            // Populate Rejection Reasons
            const rejectionSelect = document.getElementById('rejection_reason');
            CONFIG.REJECTION_REASONS.forEach(reason => {
                const option = document.createElement('option');
                option.value = reason;
                option.textContent = reason;
                rejectionSelect.appendChild(option);
            });
        }
        
        function getFailurePointKey(displayName) {
            const mapping = {
                "Accounts check": "accounts",
                "Accessories": "accessories",
                "Authenticity check": "auth",
                "Battery test": "battery",
                "Buttons test": "buttons",
                "Controller test (incl. vibration)": "controller",
                "Disc drive and storage test": "disc_storage",
                "Display test": "display",
                "Jailbreak test": "jailbreak",
                "Load test": "load",
                "Network connections test": "network",
                "Noise and smell test": "noise_smell",
                "Ports test": "ports",
                "Powering on and booting up": "boot",
                "Speaker and microphone test": "speaker_mic"
            };
            return mapping[displayName] || displayName.toLowerCase().replace(/[^a-z]/g, '_');
        }

        // ================= FORM FUNCTIONS =================
        function selectForm(formId) {
            CURRENT_FORM = formId;
            
            // Set correct field IDs
            if (formId === 'form3') currentFieldIds = CONFIG.FIELD_IDS.PASS_ALL;
            else if (formId === 'form1') currentFieldIds = CONFIG.FIELD_IDS.FAILED_TEST;
            else currentFieldIds = CONFIG.FIELD_IDS.REJECTION;
            
            // Update UI selection
            document.getElementById('form3Option').classList.remove('selected');
            document.getElementById('form1Option').classList.remove('selected');
            document.getElementById('form2Option').classList.remove('selected');
            document.getElementById(formId + 'Option').classList.add('selected');
            
            // Update preview text
            if (formId === 'form3') {
                document.getElementById('formPreview').innerHTML = 
                    'Currently selected: <strong style="color:#00cc66">PASS ALL TESTS</strong> ‚Äî All tests passed or not testable';
            } else if (formId === 'form1') {
                document.getElementById('formPreview').innerHTML = 
                    'Currently selected: <strong style="color:#ff3333">FAILED TEST</strong> ‚Äî Detailed testing with cascade logic';
            } else {
                document.getElementById('formPreview').innerHTML = 
                    'Currently selected: <strong style="color:#ff3333">REJECTION</strong> ‚Äî Single reason rejection';
            }
            
            // Show/hide form sections
            if (formId === 'form3') {
                document.getElementById('liveFormFields').style.display = 'block';
                document.getElementById('rejectionFormFields').style.display = 'none';
                document.getElementById('passAllFormFields').style.display = 'block';
                document.getElementById('failureFields').style.display = 'none';
                document.getElementById('notTestableBox').style.display = 'none';
                
            } else if (formId === 'form1') {
                document.getElementById('liveFormFields').style.display = 'block';
                document.getElementById('rejectionFormFields').style.display = 'none';
                document.getElementById('passAllFormFields').style.display = 'none';
                document.getElementById('failureFields').style.display = 'block';
                document.getElementById('notTestableBox').style.display = 'none';
                
            } else if (formId === 'form2') {
                document.getElementById('liveFormFields').style.display = 'none';
                document.getElementById('rejectionFormFields').style.display = 'block';
                document.getElementById('passAllFormFields').style.display = 'none';
                document.getElementById('notTestableBox').style.display = 'none';
            }
        }

        function updateFailureReasons() {
            const failurePoint = document.getElementById('failure_point').value;
            const reasonSelect = document.getElementById('failure_reason');
            
            reasonSelect.innerHTML = '<option value="">-- Select Failure Reason --</option>';
            
            if (!failurePoint) return;
            
            const pointName = CONFIG.FAILURE_POINTS.find(p => getFailurePointKey(p) === failurePoint);
            const reasons = CONFIG.FAILURE_REASONS[pointName] || ["Other"];
            
            reasons.forEach(reason => {
                const option = document.createElement('option');
                option.value = reason;
                option.textContent = reason;
                reasonSelect.appendChild(option);
            });
        }

        function updateNotTestableInfo() {
            const model = document.getElementById('model').value;
            const notTestableBox = document.getElementById('notTestableBox');
            const notTestableList = document.getElementById('notTestableList');
            
            notTestableList.innerHTML = '';
            
            if (CURRENT_FORM !== 'form3') {
                notTestableBox.style.display = 'none';
                return;
            }
            
            if (!model) {
                notTestableBox.style.display = 'none';
                return;
            }
            
            const specialTests = CONSTANTS.SPECIAL_CONSOLES[model];
            
            if (specialTests && specialTests.length > 0) {
                notTestableBox.style.display = 'block';
                
                specialTests.forEach(test => {
                    const li = document.createElement('li');
                    li.textContent = getTestDisplayName(test);
                    notTestableList.appendChild(li);
                });
            } else {
                notTestableBox.style.display = 'none';
            }
        }
        
        function getTestDisplayName(testKey) {
            const testNames = {
                "auth": "Authenticity check",
                "boot": "Powering on and booting up",
                "buttons": "Buttons test",
                "jailbreak": "Jailbreak test",
                "network": "Network connections test",
                "accounts": "Accounts check",
                "ports": "Ports test",
                "disc_storage": "Disc drive and storage test",
                "battery": "Battery test",
                "display": "Display test",
                "speaker_mic": "Speaker and microphone test",
                "load": "Load test",
                "noise_smell": "Noise and smell test",
                "controller": "Controller test",
                "accessories": "Accessories test"
            };
            return testNames[testKey] || testKey;
        }

        // ================= NAVIGATION FUNCTIONS =================
        function setupAutoNavigation() {
            // Item ID ‚Üí Serial
            document.getElementById('item_id').addEventListener('input', function() {
                const value = this.value.replace(/\t/g, '');
                if (value !== this.value) {
                    this.value = value;
                }
                
                if (value.length === 8) {
                    setTimeout(() => {
                        document.getElementById('serial').focus();
                    }, 50);
                }
            });

            // Serial ‚Üí Next field
            document.getElementById('serial').addEventListener('input', function() {
                const value = this.value.replace(/\t/g, '');
                if (value !== this.value) {
                    this.value = value;
                }
                
                if (value.length > 0) {
                    setTimeout(() => {
                        if (CURRENT_FORM === 'form3' || CURRENT_FORM === 'form1') {
                            document.getElementById('model').focus();
                        } else if (CURRENT_FORM === 'form2') {
                            document.getElementById('rejection_reason').focus();
                        }
                    }, 50);
                }
            });

            // Model ‚Üí Next field
            document.getElementById('model').addEventListener('change', function() {
                if (this.value) {
                    setTimeout(() => {
                        if (CURRENT_FORM === 'form3') {
                            document.querySelector('.btn-success').focus();
                        } else if (CURRENT_FORM === 'form1') {
                            document.getElementById('failure_point').focus();
                        }
                    }, 50);
                    
                    updateNotTestableInfo();
                }
            });

            // Failure Point ‚Üí Failure Reason
            document.getElementById('failure_point').addEventListener('change', function() {
                if (CURRENT_FORM === 'form1' && this.value) {
                    updateFailureReasons();
                    setTimeout(() => {
                        document.getElementById('failure_reason').focus();
                    }, 50);
                }
            });

            // Failure Reason ‚Üí Submit button
            document.getElementById('failure_reason').addEventListener('change', function() {
                if (CURRENT_FORM === 'form1' && this.value) {
                    setTimeout(() => {
                        document.querySelector('.btn-success').focus();
                    }, 50);
                }
            });

            // Rejection Reason ‚Üí Submit button
            document.getElementById('rejection_reason').addEventListener('change', function() {
                if (CURRENT_FORM === 'form2' && this.value) {
                    setTimeout(() => {
                        document.querySelector('.btn-success').focus();
                    }, 50);
                }
            });

            // Handle Tab from scanner
            document.getElementById('item_id').addEventListener('keydown', function(e) {
                if (e.key === 'Tab') {
                    e.preventDefault();
                    const cleanValue = this.value.replace(/\t/g, '').substring(0, 8);
                    this.value = cleanValue;
                    document.getElementById('serial').focus();
                }
            });

            document.getElementById('serial').addEventListener('keydown', function(e) {
                if (e.key === 'Tab') {
                    e.preventDefault();
                    const cleanValue = this.value.replace(/\t/g, '');
                    this.value = cleanValue;
                    if (CURRENT_FORM === 'form3' || CURRENT_FORM === 'form1') {
                        document.getElementById('model').focus();
                    } else if (CURRENT_FORM === 'form2') {
                        document.getElementById('rejection_reason').focus();
                    }
                }
            });
        }

        // ================= FORM GENERATION FUNCTIONS =================
        function collectFormData() {
            const itemId = sanitizeInput(document.getElementById('item_id').value.trim());
            const serial = sanitizeInput(document.getElementById('serial').value.trim());
            
            // Validate Item ID (numbers only)
            if (!/^\d{1,8}$/.test(itemId)) {
                alert("‚ùå Item ID must be 1-8 digits (numbers only)");
                return null;
            }
            
            if (!itemId || !serial) {
                alert("‚ùå Please fill Item ID and Serial Number");
                return null;
            }
            
            const formData = {
                formType: CURRENT_FORM,
                itemId: itemId,
                serial: serial
            };
            
            if (CURRENT_FORM === 'form3' || CURRENT_FORM === 'form1') {
                const model = document.getElementById('model').value;
                
                if (!model) {
                    alert("‚ùå Please select Model");
                    return null;
                }
                
                formData.model = model;
                
                if (CURRENT_FORM === 'form1') {
                    const failurePoint = document.getElementById('failure_point').value;
                    const failureReason = document.getElementById('failure_reason').value;
                    
                    if (!failurePoint) {
                        alert("‚ùå Please select Failure Point for FAILED TEST form");
                        return null;
                    }
                    
                    formData.failurePoint = failurePoint;
                    formData.failureReason = failureReason || "Other";
                }
                
            } else if (CURRENT_FORM === 'form2') {
                const rejectionReason = document.getElementById('rejection_reason').value;
                
                if (!rejectionReason) {
                    alert("‚ùå Please select a rejection reason");
                    return null;
                }
                
                formData.rejectionReason = rejectionReason;
            }
            
            return formData;
        }

        function generateAndOpenForm() {
            const formData = collectFormData();
            if (!formData) return;
            
            const url = generateFormURL(formData);
            
            // Validate Google Form URL
            if (!validateGoogleFormUrl(url)) {
                alert("‚ö†Ô∏è Invalid form URL. Please check configuration.");
                return;
            }
            
            if (url && url !== "#") {
                window.open(url, '_blank');
                
                // Show success message
                const successMsg = document.getElementById('successMessage');
                successMsg.style.display = 'block';
                setTimeout(() => {
                    successMsg.style.display = 'none';
                }, 3000);
                
                clearForm();
            }
        }

        function generateFormURL(formData) {
            let baseUrl, fieldIds;
            
            if (formData.formType === 'form3') {
                baseUrl = CONFIG.GOOGLE_FORMS.PASS_ALL;
                fieldIds = CONFIG.FIELD_IDS.PASS_ALL;
            } else if (formData.formType === 'form1') {
                baseUrl = CONFIG.GOOGLE_FORMS.FAILED_TEST;
                fieldIds = CONFIG.FIELD_IDS.FAILED_TEST;
            } else {
                baseUrl = CONFIG.GOOGLE_FORMS.REJECTION;
                fieldIds = CONFIG.FIELD_IDS.REJECTION;
            }
            
            if (!baseUrl) return "#";
            
            let url = baseUrl + (baseUrl.includes('?') ? '&' : '?');
            let params = [];
            
            if (formData.formType === 'form3') {
                params.push(fieldIds.item_id + "=" + encodeURIComponent(formData.itemId));
                params.push(fieldIds.serial + "=" + encodeURIComponent(formData.serial));
                
                if (formData.model) {
                    params.push(fieldIds.model + "=" + encodeURIComponent(formData.model));
                }
                
                CONSTANTS.TESTS.forEach(test => {
                    if (CONSTANTS.SPECIAL_CONSOLES[formData.model] && 
                        CONSTANTS.SPECIAL_CONSOLES[formData.model].includes(test)) {
                        params.push(fieldIds[test] + "=" + encodeURIComponent("Not testable"));
                    } else {
                        params.push(fieldIds[test] + "=" + encodeURIComponent("Passed"));
                    }
                });
                
                params.push(fieldIds.general + "=" + encodeURIComponent("passed"));
                
            } else if (formData.formType === 'form1') {
                params.push(fieldIds.item_id + "=" + encodeURIComponent(formData.itemId));
                params.push(fieldIds.serial + "=" + encodeURIComponent(formData.serial));
                
                if (formData.model) {
                    params.push(fieldIds.model + "=" + encodeURIComponent(formData.model));
                }
                
                let failed = false;
                CONSTANTS.TESTS.forEach(test => {
                    if (failed) {
                        params.push(fieldIds[test] + "=" + encodeURIComponent("Not testable"));
                    } else if (test === formData.failurePoint) {
                        params.push(fieldIds[test] + "=" + encodeURIComponent("Failed"));
                        failed = true;
                    } else {
                        params.push(fieldIds[test] + "=" + encodeURIComponent("Passed"));
                    }
                });
                
                if (formData.failurePoint && formData.failureReason) {
                    const whyField = fieldIds[formData.failurePoint + "_why"];
                    if (whyField) {
                        params.push(whyField + "=" + encodeURIComponent(formData.failureReason || "Other"));
                    }
                }
                
                params.push(fieldIds.general + "=" + encodeURIComponent("failed"));
                
            } else if (formData.formType === 'form2') {
                params.push(fieldIds.item_id + "=" + encodeURIComponent(formData.itemId));
                params.push(fieldIds.serial + "=" + encodeURIComponent(formData.serial));
                
                if (formData.rejectionReason) {
                    params.push(fieldIds.rejection_reason + "=" + encodeURIComponent(formData.rejectionReason));
                }
                
                params.push(fieldIds.general + "=" + encodeURIComponent("failed"));
            }
            
            url += params.join('&');
            url = url.replace(/[&?]+$/, '');
            
            return url;
        }

        // ================= UTILITY FUNCTIONS =================
        function sanitizeInput(input) {
            return input
                .replace(/[\r\n\t]/g, '')
                .replace(/[<>"'&]/g, '')
                .substring(0, 50);
        }

        function validateGoogleFormUrl(url) {
            const googleFormRegex = /^https:\/\/docs\.google\.com\/forms\/d\/e\/[A-Za-z0-9_-]+\/.*$/;
            return googleFormRegex.test(url);
        }

        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'Enter') {
                    e.preventDefault();
                    generateAndOpenForm();
                    return;
                }
                if (e.ctrlKey && e.key === '1') {
                    e.preventDefault();
                    selectForm('form3');
                    return;
                }
                if (e.ctrlKey && e.key === '2') {
                    e.preventDefault();
                    selectForm('form1');
                    return;
                }
                if (e.ctrlKey && e.key === '3') {
                    e.preventDefault();
                    selectForm('form2');
                    return;
                }
                if (e.key === 'F2') {
                    e.preventDefault();
                    const now = Date.now();
                    if (now - lastF2Time > 500) {
                        swapIdSerial();
                        lastF2Time = now;
                    }
                    return;
                }
                if (e.key === 'Escape') {
                    clearForm();
                    return;
                }
            });
        }

        function swapIdSerial() {
            const itemId = document.getElementById('item_id');
            const serial = document.getElementById('serial');
            
            const temp = itemId.value;
            itemId.value = serial.value;
            serial.value = temp;
        }

        function clearForm() {
            document.getElementById('item_id').value = '';
            document.getElementById('serial').value = '';
            document.getElementById('model').value = '';
            document.getElementById('failure_point').value = '';
            document.getElementById('failure_reason').value = '';
            document.getElementById('rejection_reason').value = '';
            
            document.getElementById('notTestableBox').style.display = 'none';
            
            document.getElementById('item_id').focus();
        }
    </script>
</body>
</html>
